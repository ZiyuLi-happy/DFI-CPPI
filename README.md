# DFI-CPPI
A multi-omics framework integrating proteomic  correlations, partial correlations, and Gene Ontology semantic similarities to construct  context-specific PPI networks.
<img width="1685" height="1019" alt="image" src="https://github.com/user-attachments/assets/f9d10eef-d792-41ba-97df-ae1c26ad9475" />
calculate_cor_prob.ipynb
  # Step 1: Data Loading and Preprocessing  
  - Load proteomics data (CSV files).  
  - Calculate correlation coefficients (Pearson and Partial Correlation).  
  - Flatten the upper triangular part of the correlation coefficient matrices into a list of protein pairs.  

  # Step 2: Logistic Regression Model Training and Prediction  
  - Load known protein-protein interactions (from the CORUM database) as labels.  
  - Train a Logistic Regression model.  
  - Output prediction probabilities.  

  # Step 3: XGBoost Model Training and Evaluation  
  - Train XGBoost models using various feature combinations and perform hyperparameter tuning.  
  - Evaluate the performance of different feature combinations (ROC curves, PR curves, etc.).  
  - Save the best model and prediction results.  

  # Step 4: Result Saving

# Differential Protein Interaction Analysis Pipeline（calculate_cor_prob.ipynb）
# Overview
This Python script implements a permutation-based differential protein-protein interaction (PPI) network analysis pipeline. It identifies statistically significant changes in protein interaction probabilities between normal and cancer conditions using machine learning and permutation testing.
# Key Features
- Correlation Analysis​​: Computes both Pearson and Partial Correlation coefficients using LedoitWolf shrinkage
- Machine Learning Integration​​: Uses pre-trained XGBoost models for interaction probability prediction
- ​​Statistical Testing​​: Implements permutation testing with multiple p-value calculation methods
- Parallel Processing​​: Efficient handling of large-scale protein interaction data
- Comprehensive Output​​: Provides probabilities, p-values, and FDR-corrected results

# Workflow
1. Data Loading & Preprocessing
Loads protein expression data from CSV files (normal vs cancer samples)
Computes correlation matrices and flattens to protein pair lists
Integrates Gene Ontology (GO) similarity features
2. Feature Engineering
​​Correlation Features​​: Pearson and partial correlation coefficients
​​GO Similarity​​: Molecular Function (MF), Biological Process (BP), Cellular Component (CC)
​​Protein Pair Normalization​​: Ensures consistent pair ordering
3. Model Prediction
Loads pre-trained machine learning model
Predicts interaction probabilities for both conditions
Calculates probability differences (cancer vs normal)
4. Permutation Testing & Significance
​​Null Distribution​​: Generated by random sample label shuffling
​​P-value Methods​​:
Empirical: Based on permutation distribution
Z-score: Using normal approximation
​​Multiple Testing Correction​​: False Discovery Rate (FDR) adjustment
